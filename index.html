<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Bestellungen</title>
  <style>
    .bestellung {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 12px;
      border-radius: 6px;
      background-color: #f9f9f9;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 8px 12px;
      cursor: pointer;
      margin: 8px 0;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>

  <h2>ðŸ“¦ Bestellungen speichern</h2>

  <button onclick="abschliessen()">ðŸ’¾ Bestellung speichern</button>
  <button onclick="toggleGespeicherteBestellungen()">ðŸ“‚ Gespeicherte Bestellungen ein-/ausblenden</button>

  <div id="gespeicherteBestellungen" style="display: none;"></div>

  <script>
    let bestellungen = JSON.parse(localStorage.getItem('bestellungen') || '[]');

    function abschliessen() {
      const dummyKunde = {
        name: 'Beispiel GmbH',
        ort: 'Berlin',
        vorname: 'Max',
        nachname: 'Mustermann',
        strasse: 'MusterstraÃŸe 1',
        plz: '12345',
        land: 'Deutschland',
        ustid: '',
        telefon: '01234 567890',
        email: 'max@example.com'
      };

      const bestellung = {
        kunde: dummyKunde,
        lieferdatum: new Date().toISOString().split('T')[0],
        kommentar: 'Testbestellung',
        zeitstempel: new Date().toISOString(),
        positionen: [
          { artikelnummer: '1234', artikelname: 'Produkt A', menge: 2, preis: '10.00', gesamtpreis: '20.00' },
          { artikelnummer: '5678', artikelname: 'Produkt B', menge: 1, preis: '15.00', gesamtpreis: '15.00' }
        ]
      };

      bestellungen.push(bestellung);
      localStorage.setItem('bestellungen', JSON.stringify(bestellungen));
      alert('Bestellung gespeichert!');
    }

    function zeigeGespeicherteBestellungen() {
      const container = document.getElementById('gespeicherteBestellungen');
      container.innerHTML = '';

      const gespeicherte = JSON.parse(localStorage.getItem('bestellungen') || '[]');

      if (gespeicherte.length === 0) {
        container.textContent = 'Keine gespeicherten Bestellungen gefunden.';
        return;
      }

      gespeicherte.forEach((b, index) => {
        const div = document.createElement('div');
        div.className = 'bestellung';
        div.innerHTML = `
          <h4>Bestellung #${index + 1}</h4>
          <p><strong>Kunde:</strong> ${b.kunde.name} (${b.kunde.ort})</p>
          <p><strong>Lieferdatum:</strong> ${b.lieferdatum}</p>
          <p><strong>Kommentar:</strong> ${b.kommentar || '-'}</p>
          <ul>
            ${b.positionen.map(p => `<li>${p.menge} Ã— ${p.artikelname} â€“ ${p.gesamtpreis} â‚¬</li>`).join('')}
          </ul>
        `;
        container.appendChild(div);
      });
    }

    function toggleGespeicherteBestellungen() {
      const el = document.getElementById('gespeicherteBestellungen');
      if (el.style.display === 'none' || el.innerHTML === '') {
        zeigeGespeicherteBestellungen();
        el.style.display = 'block';
      } else {
        el.style.display = 'none';
      }
    }
  </script>
</body>
</html>
